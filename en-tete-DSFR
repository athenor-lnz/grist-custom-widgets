<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>En-tête DSFR autonome</title>

  <!-- DSFR CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/dsfr/dsfr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/dsfr/utility/utilities.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/utility/icons/icons.min.css">

  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: white;
    }

    .fr-header,
    .fr-header__brand {
      filter: none !important;
      --hover: transparent;
    }

    #config-form {
      display: none;
      max-width: 480px;
      margin: 2rem auto;
    }
  </style>
</head>

<body>
  <!-- Formulaire de configuration -->
  <form id="config-form" class="fr-container">
    <h3 class="fr-h5">Configurer l’en-tête DSFR</h3>

    <div class="fr-select-group">
      <label class="fr-label" for="intitule">Bloc marque (ministère / administration)</label>
      <select class="fr-select" id="intitule" name="intitule" required>
        <option value="">— Sélectionner un intitulé officiel —</option>
      </select>
    </div>

    <div class="fr-input-group">
      <label class="fr-label" for="nomService">Nom du service</label>
      <input class="fr-input" id="nomService" name="nomService" type="text">
    </div>

    <div class="fr-input-group">
      <label class="fr-label" for="baseline">Baseline (sous-titre)</label>
      <input class="fr-input" id="baseline" name="baseline" type="text">
    </div>

    <div class="fr-input-group">
      <label class="fr-label" for="logoUrl">Logo (URL d’une image)</label>
      <input class="fr-input" id="logoUrl" name="logoUrl" type="url" placeholder="https://exemple.com/logo.png">
    </div>

    <div class="fr-btns-group fr-btns-group--right fr-mt-3w">
      <button class="fr-btn" type="submit">Afficher l’en-tête</button>
    </div>
  </form>

  <!-- En-tête DSFR -->
  <header role="banner" class="fr-header" id="header-2" style="display:none;">
    <div class="fr-header__body">
      <div class="fr-container">
        <div class="fr-header__body-row">
          <div class="fr-header__brand fr-enlarge-link">
            <div class="fr-header__brand-top">
              <div class="fr-header__logo">
                <p class="fr-logo" id="intitule-officiel">République<br>Française</p>
              </div>
              <div class="fr-header__operator" id="operator-section" style="display: none;">
                <img class="fr-responsive-img" style="max-width: 9.0625rem;" id="logo-img" alt="Logo" />
              </div>
            </div>
            <div class="fr-header__service">
              <p class="fr-header__service-title" id="nom-service"></p>
              <p class="fr-header__service-tagline" id="baseline-text"></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- DSFR JS -->
  <script src="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/dsfr/dsfr.module.min.js" type="module"></script>
  <script src="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.13.1/dist/dsfr/dsfr.nomodule.min.js" nomodule></script>

  <script>
    // === ⚙️ Paramètre de réinitialisation ===
    const forceResetConfig = true;

    // === Césures officielles DSFR ===
    const cesuresAdmin = {
      "Premier ministre": "Premier<br>ministre",
      "Ministère de l’Intérieur": "Ministère<br>de l’Intérieur",
      "Ministère des Armées": "Ministère<br>des Armées",
      "Ministère de la Justice": "Ministère<br>de la Justice",
      "Ministère de la Culture": "Ministère<br>de la Culture",
      "Ministère de l’Économie et des Finances": "Ministère<br>de l’Économie<br>et des Finances",
      "Ministère de la Transition écologique et solidaire": "Ministère<br>de la Transition<br>écologique et solidaire",
      "Ministère des Solidarités et de la Santé": "Ministère<br>des Solidarités<br>et de la Santé",
      "Ministère de l’Éducation nationale et de la Jeunesse": "Ministère<br>de l’Éducation<br>nationale et de la Jeunesse",
      "Ministère des Sports": "Ministère<br>des Sports",
      "Ministère des Outre-mer": "Ministère<br>des Outre-mer",
      "Ministère de la Cohésion des territoires": "Ministère<br>de la Cohésion<br>des territoires",
      "Ministère de l’Agriculture et de l’Alimentation": "Ministère<br>de l’Agriculture<br>et de l’Alimentation"
    };

    function initSelect() {
      const select = document.getElementById('intitule');
      Object.keys(cesuresAdmin).forEach(key => {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = key;
        select.appendChild(option);
      });
    }

    function afficherHeader(data) {
      const header = document.getElementById('header-2');
      const form = document.getElementById('config-form');
      form.style.display = 'none';
      header.style.display = 'block';

      const intituleElem = document.getElementById('intitule-officiel');
      const nomServiceElem = document.getElementById('nom-service');
      const baselineElem = document.getElementById('baseline-text');
      const operatorSection = document.getElementById('operator-section');
      const logoImg = document.getElementById('logo-img');

      const intitule = data.intitule.trim();
      intituleElem.innerHTML = cesuresAdmin[intitule] || intitule.replace(/\n/g, '<br>');
      nomServiceElem.textContent = data.nomService || "";
      baselineElem.textContent = data.baseline || "";

      if (data.logoUrl) {
        logoImg.src = data.logoUrl;
        operatorSection.style.display = 'block';
      } else {
        operatorSection.style.display = 'none';
      }
    }

    function sauvegarder(data) {
      localStorage.setItem('headerDSFR', JSON.stringify(data));
    }

    document.addEventListener('DOMContentLoaded', () => {
      initSelect();
      const form = document.getElementById('config-form');
      const header = document.getElementById('header-2');
      form.style.display = 'none';
      header.style.display = 'none';

      if (forceResetConfig) {
        localStorage.removeItem('headerDSFR');
      }

      const saved = localStorage.getItem('headerDSFR');
      if (saved) {
        const data = JSON.parse(saved);
        afficherHeader(data);
      } else {
        form.style.display = 'block';
        form.addEventListener('submit', (e) => {
          e.preventDefault();
          const data = {
            intitule: document.getElementById('intitule').value,
            nomService: document.getElementById('nomService').value,
            baseline: document.getElementById('baseline').value,
            logoUrl: document.getElementById('logoUrl').value
          };
          sauvegarder(data);
          afficherHeader(data);
        });
      }
    });
  </script>
</body>

</html>
